<html><head>
<script>
<!-- hide from old browsers
var newWindow = null

function GCD(e,PHI) {
if (e > PHI) {
     while (e%PHI != 0) {
          a = e%PHI
          e = PHI
          PHI = a
     }
     great = PHI
} else {
     while (PHI%e != 0) {
          a = PHI%e
          PHI = e
          e = a
     }
     great = e
}
return great
}

function tofindE(PHI,P,Q) {
great = 0
e = 2
while (great != 1) {
     e = e + 1
     great = GCD(e,PHI)
     PHI = (P - 1) * (Q - 1)
}
return e
}

function extend(E,PHI) {
u1 = 1
u2 = 0
u3 = PHI
v1 = 0
v2 = 1
v3 = E     

while (v3 != 0) {
     q = Math.floor(u3/v3)
     t1 = u1 - q * v1
     t2 = u2 - q * v2
     t3 = u3 - q * v3

     u1 = v1
     u2 = v2 
     u3 = v3

     v1 = t1
     v2 = t2
     v3 = t3
     z = 1
}
uu = u1
vv = u2

if (vv < 0) {
          inverse = vv + PHI
} else {
     inverse = vv
}
return inverse
}    
 

function result(form) {
var P = (form.prime1.options[form.prime1.selectedIndex].value)
var Q = (form.prime2.options[form.prime2.selectedIndex].value)
PHI = (P - 1) * (Q - 1)
E = tofindE(PHI,P,Q)
if (newWindow == null) {
     var newWindow = window.open("","","height=400,width=400")
     }
     newWindow.document.write("<html><body><b>")
     newWindow.document.write("N = P x Q = " + P + "x " + Q + "= ")
     newWindow.document.write(P * Q)
     newWindow.document.write("</b><br>")
     newWindow.document.write("PHI = (P-1)(Q-1) = " + PHI)
     newWindow.document.write("<br>")
     newWindow.document.write("The public exponent E will be ")
     newWindow.document.write("generated by the computer ")
     newWindow.document.write("so that the greater common divisor of ")
     newWindow.document.write("E and PHI is 1. In other words, ")
     newWindow.document.write("E is relatively prime with PHI.")
     newWindow.document.write("<br>")
     newWindow.document.write("<b>E = " + E)
     
     newWindow.document.write("</b><p>")
     newWindow.document.write("N and E are your public keys. Your ")
     newWindow.document.write("private key (D) is the inverse of E ")
     newWindow.document.write("modulo PHI.")
     newWindow.document.write("<p>") 
     newWindow.document.write("By using extended Euclidian ")
     newWindow.document.write("algorithm, the private key, <b>D, ")
     newWindow.document.write("is " + extend(E,PHI))
     newWindow.document.write("<p>Don't forget to record N, E and D!")
     newWindow.document.write("</b><p> Now, you can give your pair of ")
     newWindow.document.write("public keys, E and N, to Bob ")
     newWindow.document.write("so that he can send you encrypted letter")
     newWindow.document.write(" by using those key. Later, you ")
     newWindow.document.write("can decrypt it, using D and N.")
     newWindow.document.write("</body> </html>")
     newWindow.document.close()
}

// end script hiding -->
</script>
<title>Alice</title>
</head>

<body bgcolor="#ffffff">

<center>
<h1>KEY GENERATION PAGE</h1>
</center>

<font size="+1">
<b>OBJECTIVE:</b><br>
The purpose of this page is to generate a public key pair and a private
key pair, by choosing two available primes. In real cryptography system,
very large primes are used.
</font>

<p>
By entering two primes, P and Q, computer will generate N, E and D. E and
N are the public key pair, while D and N are the private key pair. It is
very important that you <b>write down those numbers ( N,E and D.)</b> You
will need E and N for encryption, and D and N for decryption.

</p><p>
</p><hr>
<p>
Pick 2 primes (P &amp; Q):

</p><form>
<select name="prime1">
<option value="5" selected="">5
</option><option value="7">7 </option><option value="11">11 </option><option value="13">13
</option><option value="19">19 </option><option value="17">17 </option><option value="23">23
</option><option value="29">29 </option><option value="31">31 </option><option value="37">37

</option></select>

<select name="prime2">
<option value="3" selected="">3 </option><option value="5">5
</option><option value="7">7 </option><option value="11">11 </option><option value="13">13
</option><option value="17">17 </option><option value="19">19 </option><option value="23">23
</option></select>

<p>

<input onclick="result(this.form)" type="button" value="Proceed">
</p></form>

<p>
</p><center>
    |<a href="index.html" target="">Main Page</a> |<a href="Encryption.html" target="">Encryption 
    Page</a> |<a href="Decryption.html" target="">Decryption Page</a>| 
  </center>


</body></html>