<html><head>
    
<script>
<!-- hide from old browsers
var newWindow = null
// this to find GCD of e and PHI
function GCD(e,PHI) {
if (PHI == 0){return e;}
else {
    
    var remainder = e%PHI;
    return GCD( PHI, remainder);
}    
    
}
// find E
function findE(PHI,P,Q) {
great = 0
e = 2
while (great != 1) {
     e = e + 1
     great = GCD(e,PHI)
     PHI = (P - 1) * (Q - 1)
}
return e
}
// find the private key D
function findD(E,PHI) {
u1 = 1
u2 = 0
u3 = PHI
v1 = 0
v2 = 1
v3 = E     

while (v3 != 0) {
     q = Math.floor(u3/v3)
     t1 = u1 - q * v1
     t2 = u2 - q * v2
     t3 = u3 - q * v3

     u1 = v1
     u2 = v2 
     u3 = v3

     v1 = t1
     v2 = t2
     v3 = t3
     z = 1
}
uu = u1
vv = u2

if (vv < 0) {
          inverse = vv + PHI
} else {
     inverse = vv
}
return inverse
}    
 

function result(form) {
var P = (form.prime1.options[form.prime1.selectedIndex].value)
var Q = (form.prime2.options[form.prime2.selectedIndex].value)
PHI = (P - 1) * (Q - 1)
E = findE(PHI,P,Q)
if (newWindow == null) {
     var newWindow = window.open("","","height=400,width=400")
     }
     newWindow.document.write("<html><body><b>")
     newWindow.document.write("N = P x Q = " + P + "x " + Q + "= ")
     newWindow.document.write(P * Q)
     newWindow.document.write("</b><br>")
     newWindow.document.write("<b>PHI = (P-1)(Q-1) = " + PHI + "</b>")
     newWindow.document.write("<br><br>")
     newWindow.document.write("The public exponent E will be ")
     newWindow.document.write("generated by the computer ")
     newWindow.document.write("<br>")
     newWindow.document.write("E has to be relatively prime with PHI.")
     newWindow.document.write("<br>")
     newWindow.document.write("<b>E = " + E) 
     newWindow.document.write("</b><p>")
     newWindow.document.write("The <b> public key</b> is: (N, E).")
     newWindow.document.write("<br>")                        
     newWindow.document.write("The <b> private key</b> is: D which is the inverse of E ")
     newWindow.document.write("modulo PHI.")
     newWindow.document.write("<p>") 
     newWindow.document.write("By using extended Euclidian algorithm, ")
     newWindow.document.write("<br>")
     newWindow.document.write("the private key, <b>D, ")
     newWindow.document.write("is " + findD(E,PHI))
     newWindow.document.write("<p>Alice has to rememeber these keys: N, E and D!")
     newWindow.document.write("</b><p> Now, she can give this pair of ")
     newWindow.document.write("public keys, E and N, to Bob ")
     newWindow.document.write("so that he can send her encrypted message")
     newWindow.document.write(" by using those keys. Later, Alice ")
     newWindow.document.write("can decrypt it, using D and N.")
     newWindow.document.write("</body> </html>")
     newWindow.document.close()
}

// end script hiding -->
</script>
<title>Alice</title>
</head>

<body>

<center>
<h1>RSA KEY GENERATION</h1>
</center>


<b>OBJECTIVE:</b><br>
The purpose of this page is to generate a public key pair and a private
key pair, by choosing two available primes. In real cryptography system,
very large primes are used.
<p></p>
    
    <lu>
        <li> By entering two primes, P and Q, computer will generate N, E and D. </li>
        <li>E and N are the public key pair, while D and N are the private key pair.</li> 
        <li>It is very important to <b>write down those numbers ( N,E and D.)</b></li>
        <li>We will need E and N for <b>encryption</b>, and D and N for <b>decryption</b>.</li>
   </lu>
<p></p>
<hr>
<p>
Please select 2 primes (P &amp; Q):

</p>
<form>
<select name="prime1">
<option value="5" selected="">5</option>
<option value="7">7 </option>
<option value="11">11 </option>
<option value="13">13 </option>
<option value="19">19 </option>
<option value="17">17 </option>
<option value="23">23 </option>
<option value="29">29 </option>
<option value="31">31 </option>
<option value="37">37 </option>
</select>

<select name="prime2">
<option value="3" selected="">3 </option>
<option value="5">5 </option>
<option value="7">7 </option>
<option value="11">11 </option>
<option value="13">13 </option>
<option value="17">17 </option>
<option value="19">19 </option>
<option value="23">23 </option>
</select>

<p>
<input onclick="result(this.form)" type="button" value="Generate">
</p>
</form>

<p>
</p><center>
    |<a href="home.html" target="">Home</a> |<a href="Encryption.html" target="">Encryption 
    </a> |<a href="Decryption.html" target="">Decryption</a>| 
  </center>


</body></html>