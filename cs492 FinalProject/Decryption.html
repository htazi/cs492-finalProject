<html><head>
<title>Alice</title>
<script language="javascript">
<!-- hide from old browsers
var newWindow = null

function MakeArray(n) {
     this.length = n
     for (var i = 1; i <= n; i++) {
          this[i] = 0
     }
     return this
}


cipher = new MakeArray(10)
cipher[1] = "Hello Alice"
cipher[2] = "This is Bob?"
cipher[3] = "How are you?"
cipher[4] = "Can you call me when you have a chance?"
cipher[5] = "How is your familly?"
cipher[6] = "Can you help me with my final project?"
cipher[7] = "Can we meet?"
cipher[8] = "See you then"
cipher[9] = "Take care"
cipher[10] = "Thank you"

function result(form) {
var C = form.message.value
var N = form.Nvalue.value
var D = form.key.value

// decrypt the message using repeated square algorithm
if ( D % 2 == 0) {
     G = 1   // if d is even set C^1 = 1
     for ( var i = 1; i <= D/2; i++) {
               F = (C*C) % N
               G = (F*G) % N
     }
} else {
     G = C // if D is odd set C^1 = C
     for ( var i = 1; i <= D/2; i++) {
               F = (C*C) % N
               G = (F*G) % N
     }
}

cipher = cipher[G]

if (newWindow == null) {
     var newWindow = window.open("","","height=400,width=400")
     }
     newWindow.document.write("<html><body bgcolor='FFFFFF'>")
     newWindow.document.write("The encrypted message will be ")
     newWindow.document.write("decrypted using the following method:")
     newWindow.document.write("<p>")
     newWindow.document.write(" M = C^D mod N = "+C+"^"+D+" mod ")
     newWindow.document.write(N +" = "+ G)
     newWindow.document.write("<p>"+G+" is converted to a message. ")
     newWindow.document.write("The original message is: " +"<b>" +cipher+ "</b>")
     newWindow.document.write("</body></html>")
     newWindow.document.close()

}

// end script hiding -->
</script>

</head><body>

<center>
<h1>DECRYPTION</h1>
</center>

<font size="+1">
<b>OBJECTIVE:</b><br>
This is the final step of understanding RSA algorithm. The purpose is to
decrypt the encrypted message, by usingthe private key pair, D and N.
</font>

<p>
</p><hr>
<p>

</p><form>
Enter the encrypted message: <input name="message" type="text" value="0">
<p>
Enter your N value: <input name="Nvalue" type="text" value="0">
</p><p>
Enter your private key, D: <input name="key" type="text" value="0">
</p><p>
<input onclick="result(this.form)" type="button" value="Decrypt">

</p></form>

<p>
</p><center>
    |<a href="home.html" target="">Home</a> |<a href="KeyGeneration.html" target="">RAS Key 
    Generation</a> |<a href="Encryption.html" target="">Encryption</a>| 
  </center>



</body></html>